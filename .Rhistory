bd.i.gcc<-cases.dat[cases.dat$case.number==case.no,"Soil.BulkDensity.inital"]
soilP.i.mgkg<-cases.dat[cases.dat$case.number==case.no,"Soil.TPConc.inital"]
soilPgrad.i.mgcccm<-cases.dat[cases.dat$case.number==case.no,"Vertical.SoilTPGradient.inital"]
bd.f.gcc<-cases.dat[cases.dat$case.number==case.no,"Soil.BulkDensity.final"]
Psettle.myr<-cases.dat[cases.dat$case.number==case.no,"PSettlingRate"]
atmoP.mgm2yr<-cases.dat[cases.dat$case.number==case.no,"P.AtmoDep"]
RF.myr<-cases.dat[cases.dat$case.number==case.no,"Rainfall"]
ET.myr<-cases.dat[cases.dat$case.number==case.no,"ET"]
}
time<-seq(0,Max.Yrs,Time.increment.yr)
time<-time[time<=Max.Yrs]
maxdist.km<-min(c(50,Max.Dist),na.rm=T)
Dist.slice<-c(Dist.slice,Max.Dist)
time.dat<-data.frame()
for(i in 1:length(time)){
if(is.na(case.no)==T){tmp<-EPGMProfile(Start.Discharge=start.year,
STA.outflow.TPconc=outflow.c.ugL,
STA.outflow.vol=outflow.q.kacft,
FlowPath.width=path.width.km,
Hydroperiod=hydroperiod.per,
Soil.Depth=soil.z.cm,
Soil.BulkDensity.inital=bd.i.gcc,
Soil.TPConc.inital=soilP.i.mgkg,
Vertical.SoilTPGradient.inital=soilPgrad.i.mgcccm,
Soil.BulkDensity.final=bd.f.gcc,
PSettlingRate=Psettle.myr,
P.AtmoDep=atmoP.mgm2yr,
Rainfall=RF.myr,
ET=ET.myr,
raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])}
else{tmp<-EPGMProfile(case.no=case.no,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])}
tmp$time.step<-time[i]
tmp$Year<-(start.year+time[i])-1
time.dat<-rbind(tmp,time.dat)
}
time.dat<-time.dat[order(time.dat$time.step,time.dat$dist),]
#wghts<-ifelse(time.dat$dist==0|time.dat$dist==maxdist.km,0.5,1)
#cattail.flowpath<-aggregate(time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time.dat$time.step),"sum")
#Commented out may include in future iterations.
if(plot.profile==TRUE){
#Graphs_Profile plots
par(family="serif",mar=c(1.75,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:6,2,3,byrow=T),widths=c(1,0.4,1))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="black",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="black",lty=2,lwd=1)
mtext(side=3,"Soil Phosphorus")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.85,legend=c("Integrated","Steady State"),
pch=NA,lwd=c(2,1),lty=c(1,2),
col=c("black"),cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(length(Dist.slice))
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
mtext(side=3,"Soil Phosphorus")
plot(cattail.time.per~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Cattail Density (% Area)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,105))
lines(time.dat.plot$time.step,time.dat.plot$cattail.time.per,col="black",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$cattail.density.SS.per,col="black",lty=2,lwd=1)
mtext(side=3,"Cattail Density")
mtext(side=1,line=1.5,"Time (Yrs)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.85,legend=c("Integrated","Steady State"),
pch=NA,lwd=c(2,1),lty=c(1,2),
col=c("black"),cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Cattail Density\n Distance:",Dist.Display,"km"),title.adj = 0)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Cattail Density",title.adj = 0)
if(is.na(case.no)==F){
text(x=-1,y=0,paste("Case:",cases.dat[cases.dat$case.number==case.no,"case.number"],"\nSTA:",cases.dat[cases.dat$case.number==case.no,"STA.Name"],"\nRecieving Area:",cases.dat[cases.dat$case.number==case.no,"Receiving.Area"],"\nSoil Depth (cm):",cases.dat[cases.dat$case.number==case.no,"Soil.Depth"],"\nStart Year:",cases.dat[cases.dat$case.number==case.no,"Start.Discharge"]),adj=0,xpd=NA,cex=0.85)
}
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(cattail.time.per~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,105))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,cattail.time.per,lwd=2,col=cols[i]))
}
mtext(side=3,"Cattail Density")
mtext(side=1,line=1.5,"Time (Yrs)")
}
if(results.time.table==TRUE){
cell.area=path.width.km*Dist.increment.km
total.area=Max.Dist*path.width.km
wghts<-ifelse(time.dat$dist==0|time.dat$dist==maxdist.km,0.5,1)
soil.ss.time<-aggregate(time.dat$SoilP.SS.mgkg*wghts*(cell.area/total.area),by=list(time.dat$time.step),"sum")
BD<-aggregate(time.dat$BulkDensity.gcc*wghts*(cell.area/total.area),by=list(time.dat$time.step),"sum")
avg.vol.soilP<-aggregate((time.dat$Avg.SoilP.mgkg*time.dat$BulkDensity.gcc/1000)*wghts*(cell.area/total.area),by=list(time.dat$time.step),"sum")
avg.soilP<-data.frame(Group.1=avg.vol.soilP[,1],x=avg.vol.soilP[,2]/BD[,2]*1000)
cattail.ha<-aggregate(time.dat$cattail.time.per*wghts*cell.area,by=list(time.dat$time.step),"sum")
time.val<-time.dat$time.step
rpt.time.step<-if(Time.increment.yr==1){c(0,1,2,3,10,15,20,25,200)}else{c(seq(0,Max.Yrs,Time.increment.yr)[1:8],Max.Yrs)}
# Simulation information
sim.zone<-data.frame(Parameter=c("Distance.km","Width.km","Area.km2","STA.outflow.volume.kAcftyr","Hydroperiod.pct","Soil.Depth.cm","P.Settle.Rate.myr","STA.outflow.Conc.ugL","STA.outflow.Load.mtyr"),
Value=c(Max.Dist,
path.width.km,
total.area,
outflow.q.kacft,
hydroperiod.per*100,
soil.z.cm,
Psettle.myr,
outflow.c.ugL,
round((outflow.q.kacft*43560*0.001/3.28^3)*outflow.c.ugL/1000,1)))
#Time series summary
TimeProfile.summary=data.frame(Time.Step=rpt.time.step,
Year=(start.year+rpt.time.step)-1,
SoilP.mgkg=round(avg.soilP[avg.soilP$Group.1%in%rpt.time.step,2],0),
CattailDensity.ha=round(cattail.ha[cattail.ha$Group.1%in%rpt.time.step,2],0))
out.time.sum<-list("Time.yrs" = Max.Yrs, "Time.increment.yrs"=Time.increment.yr,
"Simulated.Zone"= sim.zone,
"TimeProfile"=TimeProfile.summary)
}
#class(time.dat)<-"EPGMr"
if(raw.time.output==T){return(time.dat)}
if(results.time.table==TRUE){return(out.time.sum)}
}
devtools::document()
library(EPGMr)
library(EPGMr)
casedat[11,]
time.dat=EPGMTime(case.no=11,raw.time.output=T)
head(time.dat)
diff(unique(time.dat$time.step))[1]
max(time.dat$dist)
max(time.dat$area)/max(time.dat$dist)
Time.increment.yr=diff(unique(time.dat$time.step))[1]
Max.Dist=max(time.dat$dist)
path.width.km=max(time.dat$area)/max(time.dat$dist)
Start.Discharge=min(time.dat$Year)+1
cell.area=path.width.km*Dist.increment.km
max(time.dat$area)/max(time.dat$dist)
max(time.dat$area)/max(time.dat$dist)
diff(unique(time.dat$dist))[1]
Dist.increment.km=diff(unique(time.dat$dist))[1]
cell.area=path.width.km*Dist.increment.km
total.area=Max.Dist*path.width.km
wghts<-ifelse(time.dat$dist==0|time.dat$dist==maxdist.km,0.5,1)
wghts<-ifelse(time.dat$dist==0|time.dat$dist==Max.Dist,0.5,1)
WaterColumn.Thresholds=c(10,15,20)
WCthres.1<-WaterColumn.Thresholds[1]
WCthres.2<-WaterColumn.Thresholds[2]
WCthres.3<-WaterColumn.Thresholds[3]
WCthres.1.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.1.exceed.km<-(WCthres.1.exceed[,2]*path.width.km)
WCthres.2.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.2,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.2.exceed.km<-(WCthres.2.exceed[,2]*path.width.km)
WCthres.3.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.3,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.3.exceed.km<-(WCthres.3.exceed[,2]*path.width.km)
WCthres.3.exceed.km
Soil.Thresholds=c(500,600,1000)
Soilthres.1<-Soil.Thresholds[1]
Soilthres.2<-Soil.Thresholds[2]
Soilthres.3<-Soil.Thresholds[3]
soilthres.1.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.1.exceed.km<-(soilthres.1.exceed[,2]*Dist.increment.km)*path.width.km
soilthres.2.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.2,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.2.exceed.km<-(soilthres.2.exceed[,2]*Dist.increment.km)*path.width.km
soilthres.3.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.3,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.3.exceed.km<-(soilthres.3.exceed[,2]*Dist.increment.km)*path.width.km
cattail.Thresholds=c(5,20,90)
cattailthres.1<-cattail.Thresholds[1]
cattailthres.2<-cattail.Thresholds[2]
cattailthres.3<-cattail.Thresholds[3]
cattailthres.1.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")*cell.area
cattailthres.2.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")*cell.area
cattailthres.2.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")*cell.area
cattailthres.1.exceed
aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
soilthres.1.exceed
cbind(WCthres.1.exceed.km,WCthres.2.exceed.km,WCthres.3.exceed.km)
data.frame(Time.Yrs=WCthres.1.exceed.km[,1])
WCthres.1.exceed.km
data.frame(Time.Yrs=WCthres.1.exceed[,1])
unique(time.dat)
unique(time.dat$time.step)
data.frame(Time.Yrs=unique(time.dat$time.step),Year=unique(time.dat$Year))
cbind(WCthres.1.exceed.km,WCthres.2.exceed.km,WCthres.3.exceed.km,
soilthres.1.exceed.km,soilthres.2.exceed.km,soilthres.3.exceed.km,
cattailthres.1.exceed,cattailthres.2.exceed,cattailthres.3.exceed)
cell.area=path.width.km*Dist.increment.km
total.area=Max.Dist*path.width.km
wghts<-ifelse(time.dat$dist==0|time.dat$dist==Max.Dist,0.5,1)
WaterColumn.Thresholds=c(10,15,20)
WCthres.1<-WaterColumn.Thresholds[1]
WCthres.2<-WaterColumn.Thresholds[2]
WCthres.3<-WaterColumn.Thresholds[3]
WCthres.1.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.1.exceed.km<-(WCthres.1.exceed[,2]*path.width.km)
WCthres.2.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.2,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.2.exceed.km<-(WCthres.2.exceed[,2]*path.width.km)
WCthres.3.exceed<-aggregate(ifelse(time.dat$TP.Time.ugL>WCthres.3,1,0)*wghts,by=list(time.dat$time.step),"sum")*Dist.increment.km
WCthres.3.exceed.km<-(WCthres.3.exceed[,2]*path.width.km)
Soil.Thresholds=c(500,600,1000)
Soilthres.1<-Soil.Thresholds[1]
Soilthres.2<-Soil.Thresholds[2]
Soilthres.3<-Soil.Thresholds[3]
soilthres.1.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.1.exceed.km<-(soilthres.1.exceed[,2]*Dist.increment.km)*path.width.km
soilthres.2.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.2,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.2.exceed.km<-(soilthres.2.exceed[,2]*Dist.increment.km)*path.width.km
soilthres.3.exceed<-aggregate(ifelse(time.dat$Avg.SoilP.mgkg>Soilthres.3,1,0)*wghts,by=list(time.dat$time.step),"sum")
soilthres.3.exceed.km<-(soilthres.3.exceed[,2]*Dist.increment.km)*path.width.km
cattail.Thresholds=c(5,20,90)
cattailthres.1<-cattail.Thresholds[1]
cattailthres.2<-cattail.Thresholds[2]
cattailthres.3<-cattail.Thresholds[3]
cattailthres.1.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
cattailthres.2.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
cattailthres.2.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
tmp<-cbind(WCthres.1.exceed.km,WCthres.2.exceed.km,WCthres.3.exceed.km,
soilthres.1.exceed.km,soilthres.2.exceed.km,soilthres.3.exceed.km,
cattailthres.1.exceed,cattailthres.2.exceed,cattailthres.3.exceed)
cattailthres.1.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.1,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
cattailthres.2.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.2,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
cattailthres.3.exceed<-aggregate(ifelse(time.dat$cattail.time.per>cattailthres.3,1,0)*wghts,by=list(time.dat$time.step),"sum")[,2]*cell.area
tmp<-cbind(WCthres.1.exceed.km,WCthres.2.exceed.km,WCthres.3.exceed.km,
soilthres.1.exceed.km,soilthres.2.exceed.km,soilthres.3.exceed.km,
cattailthres.1.exceed,cattailthres.2.exceed,cattailthres.3.exceed)
tmp
paste0("WC.",WaterColumn.Thresholds[1])
paste0("WC.",WaterColumn.Thresholds)
colnames(tmp)<-c(paste0("WC.",WaterColumn.Thresholds),paste0("Soil.",Soil.Thresholds),paste0("Cattail.",cattail.Thresholds))
tmp
cbind(data.frame(Time.Yrs=unique(time.dat$time.step),Year=unique(time.dat$Year)),tmp)
#watercolumn
t(data.frame(Threshold=WaterColumn.Thresholds))
start.year=min(time.dat$Year)+1
areas.table[areas.table$Group.1%in%rpt.time.step,paste0("WC.",WaterColumn.Thresholds)]
areas.table<-cbind(data.frame(Time.Yrs=unique(time.dat$time.step),Year=unique(time.dat$Year)),tmp)
areas.table[areas.table$Group.1%in%rpt.time.step,paste0("WC.",WaterColumn.Thresholds)]
#report table
rpt.time.step<-if(Time.increment.yr==1){c(0,1,2,3,10,15,20,25,200)}else{c(seq(0,Max.Yrs,Time.increment.yr)[1:8],Max.Yrs)}
max(time.dat$time.step)
Max.Yrs=max(time.dat$time.step)
#report table
rpt.time.step<-if(Time.increment.yr==1){c(0,1,2,3,10,15,20,25,200)}else{c(seq(0,Max.Yrs,Time.increment.yr)[1:8],Max.Yrs)}
areas.table[areas.table$Group.1%in%rpt.time.step,paste0("WC.",WaterColumn.Thresholds)]
areas.table
areas.table[areas.table$Group.1%in%rpt.time.step,c(paste0("WC.",WaterColumn.Thresholds))]
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("WC.",WaterColumn.Thresholds))]
cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("WC.",WaterColumn.Thresholds))])
cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("WC.",Soil.Thresholds))])
cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("Soil.",Soil.Thresholds))])
cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("Cattail.",cattail.Thresholds))])
data.frame(Thresholds=("Water Column (ug/L)","Soil (mg/kg)","Cattail Density (%)"))
data.frame(Thresholds=c("Water Column (ug/L)","Soil (mg/kg)","Cattail Density (%)"))
cattail.Thresholds
data.frame(Thresholds=c("Water Column (ug/L)","Soil (mg/kg)","Cattail Density (%)"),
Value1=c(WaterColumn.Thresholds[1],Soil.Thresholds[1],cattail.Thresholds[1]))
data.frame(Thresholds=c("Water Column (ug/L)","Soil (mg/kg)","Cattail Density (%)"),
Value1=c(WaterColumn.Thresholds[1],Soil.Thresholds[1],cattail.Thresholds[1]),
Value2=c(WaterColumn.Thresholds[2],Soil.Thresholds[2],cattail.Thresholds[2]),
Value3=c(WaterColumn.Thresholds[3],Soil.Thresholds[3],cattail.Thresholds[3]))
threshold.summary=data.frame(Thresholds=c("Water Column (ug/L)","Soil (mg/kg)","Cattail Density (%)"),
Value1=c(WaterColumn.Thresholds[1],Soil.Thresholds[1],cattail.Thresholds[1]),
Value2=c(WaterColumn.Thresholds[2],Soil.Thresholds[2],cattail.Thresholds[2]),
Value3=c(WaterColumn.Thresholds[3],Soil.Thresholds[3],cattail.Thresholds[3]))
#watercolumn
wc.area.summary=cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("WC.",WaterColumn.Thresholds))])
#Soil
soil.area.summary=cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("Soil.",Soil.Thresholds))])
#Cattail
cattail.area.summary=cbind(data.frame(Time.Step=rpt.time.step,Year=(start.year+rpt.time.step)-1),
areas.table[areas.table$Time.Yrs%in%rpt.time.step,c(paste0("Cattail.",cattail.Thresholds))])
out.sum<-list("Thresholds" = threshold.summary, "WaterColumn"=threshold.summary,
"Soil"= soil.area.summary,
"Cattail"=cattail.area.summary)
out.sum
layout(matrix(1:4,2,2,byrow=T))
head(areas.table)
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1])]~Time.Yrs,areas.table
areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1])]
areas.table<-cbind(data.frame(Time.Yrs=unique(time.dat$time.step),Year=unique(time.dat$Year)),tmp)
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Distance (km)",ylab="Concentration (\u03BC g L\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Dist),ylim=c(0,ceiling(outflow.c.ugL+outflow.c.ugL*0.1)))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table)
total.area
ceiliing(total.area)
ceiling(ceiliing(total.area))
ceiling(total.area)
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Time (Years)",ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],areas.table$Time.Yrs,col=cols[1])
##plot
#if(plot.profile==TRUE){
#Graphs_Profile plots
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
lines(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],areas.table$Time.Yrs,col=cols[1])
areas.table
areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
plot(areas.table[,c(paste0("soil.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Time (Years)",ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
par(family="serif",mar=c(1.75,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:8,4,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Time (Years)",ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2,1),lty=c(1,2),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column Thresholds",title.adj = 0)
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
par(family="serif",mar=c(1.75,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:8,4,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Time (Years)",ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab="Time (Years)",ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1])],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[3]))],col=cols[3],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))],col=cols[1],lwd=2)
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column Thresholds",title.adj = 0)
legend(0.5,0.5,legend=c(paste(Soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
areas.table
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
areas.table[,c(paste0("Cattail.",cattail.Thresholds))]
cattail.Thresholds
areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
areas.table[,c(paste0("Cattail.",cattail.Thresholds))]
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Soil")
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
par(family="serif",mar=c(1.75,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:6,3,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Soil")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(Soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Soil TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Cattail Density")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(cattail.Thresholds,"%")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=0.8,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Cattail Density Thresholds",title.adj = 0)
mtext(side=1,line=2,"Time (Years)")
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
par(family="serif",mar=c(1.75,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:6,3,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Soil")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(Soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Soil TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Cattail Density")
mtext(side=1,line=2,"Time (Years)")
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
par(family="serif",mar=c(1.75,4,2,2),oma=c(2,1,1,1),mgp=c(2.25,0.5,0));
layout(matrix(1:6,3,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab="Area exceeded (km\u00B2)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Soil")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(Soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Soil TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Cattail Density")
mtext(side=1,line=2,"Time (Years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(cattail.Thresholds,"%")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Cattail Density Thresholds",title.adj = 0)
cols<-colorRampPalette(c("#3B9AB2", "#78B7C5", "#EBCC2A", "#E1AF00", "#F21A00"))(3)
par(family="serif",mar=c(1.75,4,2,2),oma=c(2,1,1,1),mgp=c(2.25,0.5,0));
layout(matrix(1:6,3,2,byrow=T),widths=c(1,0.5))
plot(areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("WC.",WaterColumn.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Water Column")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(WaterColumn.Thresholds,"\u03BCg/L")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Water Column TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Soil.",Soil.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Soil")
mtext(side=2,line=2.5,"Area Exceeded (km\u00B2)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(Soil.Thresholds,"mg/kg")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Soil TP Thresholds",title.adj = 0)
plot(areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))]~Time.Yrs,areas.table,type="n",las=1,xlab=NA,ylab=NA,yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(total.area+total.area*0.1)))
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[1]))],col=cols[1],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[2]))],col=cols[2],lwd=2)
lines(areas.table$Time.Yrs,areas.table[,c(paste0("Cattail.",cattail.Thresholds[3]))],col=cols[3],lwd=2)
mtext(side=3,"Cattail Density")
mtext(side=1,line=2,"Time (Years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste(cattail.Thresholds,"%")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,cex=1,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title="Cattail Density Thresholds",title.adj = 0)
name(time.dat)
names(time.dat)
names(time.dat)="time.step
"
names(time.dat)
time.dat=EPGMTime(case.no=11,raw.time.output=T)
names(time.dat)=="time.step"
sum(names(time.dat)=="time.step")
length(WaterColumn.Thresholds)!=3
length(WaterColumn.Thresholds)>=2
nrow(time.dat)==0
devtools::document()
devtools::document()
library(EPGMr)
EPGMThreshold(EPGMTime(case.no=11,raw.time.output=T))
devtools::document()
library(EPGMr)
EPGMThreshold(EPGMTime(case.no=11,raw.time.output=T))
data("casedat")
casedat
t(casedat[casedat$case.number==11,])
