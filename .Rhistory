if(Dist.Display>Max.Dist){Max.Dist}else{Dist.Display}
Dist.Display=c(1,5,12,30)
Dist.Display[Dist.Display<=Max.Dist]
Dist.Display=c(1,5,12,30)
Dist.Display<-Dist.Display[Dist.Display<=Max.Dist]
time=seq(0,205,5)
time<-time[time<=Max.Yrs]
## Graphs_Site (plot #1)
dist.timeseries=data.frame()
for(i in 1:length(time)){
tmp1=EPGMProfile(case.no=11,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])
wghts=ifelse(tmp1$dist==0|tmp1$dist==maxdist.km,0.5,1)
#tmp1$cattail.area.ha=tmp1$cattail.time.per*wghts*(path.width.km*Dist.increment.km)
tmp=tmp1[tmp1$dist%in%Dist.Display,]
#dist.timeseries=rbind(dist.timeseries,
#                      data.frame(time.step=time[i],
#                                 Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
#                                 SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
#                                 Cattail.area.ha=sum(tmp1$cattail.area.ha)))
dist.timeseries=rbind(dist.timeseries,
data.frame(time.step=time[i],
Year=Start.Discharge+time[i],
SSTime.yrs=tmp$SSTime.yrs,
Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
EquilTime.yrs=tmp$EquilTime.yrs,
cattail.density.SS.per=tmp$cattail.density.SS.per,
cattail.time.per=tmp$cattail.time.per
))
}
dist.timeseries
dist.timeseries=data.frame()
for(i in 1:length(time)){
tmp1=EPGMProfile(case.no=11,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])
wghts=ifelse(tmp1$dist==0|tmp1$dist==maxdist.km,0.5,1)
#tmp1$cattail.area.ha=tmp1$cattail.time.per*wghts*(path.width.km*Dist.increment.km)
tmp=tmp1[tmp1$dist%in%Dist.Display,]
#dist.timeseries=rbind(dist.timeseries,
#                      data.frame(time.step=time[i],
#                                 Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
#                                 SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
#                                 Cattail.area.ha=sum(tmp1$cattail.area.ha)))
dist.timeseries=rbind(dist.timeseries,
data.frame(time.step=time[i],
Dist=dist,
Year=Start.Discharge+time[i],
SSTime.yrs=tmp$SSTime.yrs,
Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
EquilTime.yrs=tmp$EquilTime.yrs,
cattail.density.SS.per=tmp$cattail.density.SS.per,
cattail.time.per=tmp$cattail.time.per
))
}
dist.timeseries
dist.timeseries=data.frame()
for(i in 1:length(time)){
tmp1=EPGMProfile(case.no=11,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])
wghts=ifelse(tmp1$dist==0|tmp1$dist==maxdist.km,0.5,1)
#tmp1$cattail.area.ha=tmp1$cattail.time.per*wghts*(path.width.km*Dist.increment.km)
tmp=tmp1[tmp1$dist%in%Dist.Display,]
#dist.timeseries=rbind(dist.timeseries,
#                      data.frame(time.step=time[i],
#                                 Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
#                                 SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
#                                 Cattail.area.ha=sum(tmp1$cattail.area.ha)))
dist.timeseries=rbind(dist.timeseries,
data.frame(time.step=time[i],
Dist=tmp$dist,
Year=Start.Discharge+time[i],
SSTime.yrs=tmp$SSTime.yrs,
Avg.SoilP.mgkg=tmp$Avg.SoilP.mgkg,
SoilP.SS.mgkg=tmp$SoilP.SS.mgkg,
EquilTime.yrs=tmp$EquilTime.yrs,
cattail.density.SS.per=tmp$cattail.density.SS.per,
cattail.time.per=tmp$cattail.time.per
))
}
dist.timeseries
plot(SSTime.yrs~time.step,dist.timeseries)
plot(cattail.time.per~time.step,dist.timeseries)
cols=rainbow(length(Dist.Display))
cols
cols=rainbow(length(Dist.Display))
plot(cattail.time.per~time.step,dist.timeseries)
for(i in 1:length(Dist.Display)){
with(dist.timeseries[dist.timeseries$Dist==Dist.Display[i],],lines(time.step,cattail.time.per,lwd=1,col=cols[i]))
}
cols=rainbow(length(Dist.Display))
plot(cattail.time.per~time.step,dist.timeseries)
for(i in 1:length(Dist.Display)){
with(dist.timeseries[dist.timeseries$Dist==Dist.Display[i],],lines(time.step,cattail.time.per,lwd=2,col=cols[i]))
}
cols=rainbow(length(Dist.Display))
plot(cattail.time.per~time.step,dist.timeseries,type="n")
for(i in 1:length(Dist.Display)){
with(dist.timeseries[dist.timeseries$Dist==Dist.Display[i],],lines(time.step,cattail.time.per,lwd=2,col=cols[i]))
}
plot(cattail.time.per~Dist,dist.timeseries)
with(dist.timeseries[dist.timeseries$time.step==time[i],],lines(Dist,cattail.time.per,lwd=2,col=cols[i]))
cols=rainbow(length(time))
plot(cattail.time.per~Dist,dist.timeseries)
for(i in 1:length(time)){
with(dist.timeseries[dist.timeseries$time.step==time[i],],lines(Dist,cattail.time.per,lwd=2,col=cols[i]))
}
cols=rainbow(length(Dist.Display))
plot(cattail.time.per~time.step,dist.timeseries,type="n")
for(i in 1:length(Dist.Display)){
with(dist.timeseries[dist.timeseries$Dist==Dist.Display[i],],lines(time.step,cattail.time.per,lwd=2,col=cols[i]))
}
cols=rainbow(length(time))
plot(cattail.time.per~Dist,dist.timeseries)
for(i in 1:length(time)){
with(dist.timeseries[dist.timeseries$time.step==time[i],],lines(Dist,cattail.time.per,lwd=2,col=cols[i]))
}
devtools::document()
library(EPGMr)
?EPGMProfile
devtools::document()
library(EPGMr)
devtools::document()
library(EPGMr)
devtools::document()
library(EPGMr)
rm(list=ls(all=T));cat("\014");dev.off()
library(EPGMr)
profile.dat=EPGMProfile(case.no=11,raw.output=T,results.table=F,plot.profile = F)
cases.dat=casedat
case.no=11
summary.distance=c(0,0.5,1,2,4,8,10,20)
Max.Dist=15
summary.distance=summary.distance[summary.distance<Max.Dist]
Yr.Display=30
start.year<-cases.dat[cases.dat$case.number==case.no,"Start.Discharge"]
outflow.c.ugL<-cases.dat[cases.dat$case.number==case.no,"STA.outflow.TPconc"]
outflow.q.kacft<-cases.dat[cases.dat$case.number==case.no,"STA.outflow.vol"]
path.width.km<-cases.dat[cases.dat$case.number==case.no,"FlowPath.width"]
hydroperiod.per<-cases.dat[cases.dat$case.number==case.no,"Hydroperiod"]/100
soil.z.cm<-cases.dat[cases.dat$case.number==case.no,"Soil.Depth"]
bd.i.gcc<-cases.dat[cases.dat$case.number==case.no,"Soil.BulkDensity.inital"]
soilP.i.mgkg<-cases.dat[cases.dat$case.number==case.no,"Soil.TPConc.inital"]
soilPgrad.i.mgcccm<-cases.dat[cases.dat$case.number==case.no,"Vertical.SoilTPGradient.inital"]
bd.f.gcc<-cases.dat[cases.dat$case.number==case.no,"Soil.BulkDensity.final"]
Psettle.myr<-cases.dat[cases.dat$case.number==case.no,"PSettlingRate"]
atmoP.mgm2yr<-cases.dat[cases.dat$case.number==case.no,"P.AtmoDep"]
RF.myr<-cases.dat[cases.dat$case.number==case.no,"Rainfall"]
ET.myr<-cases.dat[cases.dat$case.number==case.no,"ET"]
Dist.increment.km=0.1
maxdist.km<-min(c(50,Max.Dist),na.rm=T)
TArea.km2<-path.width.km*maxdist.km
CellArea.ha<-path.width.km*0.1*100
##
Start.Discharge=1962
Max.Dist=15
Max.Yrs=200
dists=c(0,2,1,2,4,8,10,20)
dists<-dists[dists<Max.Dist]
Dist.Display=c(1,5,12,30)
Dist.Display<-Dist.Display[Dist.Display<=Max.Dist]
time=seq(0,205,5)
time<-time[time<=Max.Yrs]
time.dat<-data.frame()
for(i in 1:length(time)){
tmp<-EPGMProfile(case.no=case.no,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])
time.dat=rbind(tmp,time.dat)
}
time.dat
time.dat<-data.frame()
for(i in 1:length(time)){
tmp<-EPGMProfile(case.no=case.no,raw.output=T,results.table=F,plot.profile = F,Yr.Display =time[i])
tmp$time.step=time[i]
tmp$Year=Start.Discharge+time[i]
time.dat=rbind(tmp,time.dat)
}
time.dat
time.dat[order(time.dat$dist,time.dat$time.step),]
time.dat<-time.dat[order(time.dat$time.step,time.dat$dist),]
time.dat
path.width.km
aggregate(time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km,time.dat$time.step)
path.width.km
Dist.increment.km
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km,by=time.dat$time.step)
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km,by=list(time))
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time))
wghts=ifelse(time.dat$dist==0|time.dat$dist==maxdist.km,0.5,1)
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time))
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time),"mean")
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time),"sum")
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time.dat$time.step),"sum")
head(time.dat)
#Graphs_Profile plots
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.25,0.5,0));
layout(matrix(1:2,2,1))
plot(Avg.SoilP.mgkg~time.step,time.dat,type="n",las=1,xlab="Distance (km)",ylab="Concentration (\u03BC g L\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(time.dat$Avg.SoilP.mgkg+time.dat$Avg.SoilP.mgkg*0.1)))
time.dat
time.dat$Avg.SoilP.mgkg
plot(Avg.SoilP.mgkg~time.step,time.dat,type="n",las=1,xlab="Distance (km)",ylab="Concentration (\u03BC g L\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat$Avg.SoilP.mgkg)+max(time.dat$Avg.SoilP.mgkg)*0.1)))
lines(time.dat[dist==Dist.Display,]$time.step,time.dat[dist==Dist.Display,]$Avg.SoilP.mgkg,col="forestgreen",lty=2,lwd=2)
Dist.Display
Dist.Display=12
lines(time.dat[dist==Dist.Display,]$time.step,time.dat[dist==Dist.Display,]$Avg.SoilP.mgkg,col="forestgreen",lty=2,lwd=2)
Dist.Display
time.dat[dist==Dist.Display,]
head(time.dat)
lines(time.dat[time.dat$dist==Dist.Display,]$time.step,time.dat[time.dat$dist==Dist.Display,]$Avg.SoilP.mgkg,col="forestgreen",lty=2,lwd=2)
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Distance (km)",ylab="Concentration (\u03BC g L\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Distance (km)",ylab="Concentration (\u03BC g L\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=2,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
#Graphs_Profile plots
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.5,0.5,0));
layout(matrix(1:2,2,1))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:2,2,1))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
legend("topright",legend=c(paste("soil P at Distance",Dist.Display,"km"),"Steady State",paste("Distance =",Dist.Display,'km')),
pch=NA,lwd=c(2,1),lty=c(2,1,3),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
legend("bottomright",legend=c(paste("Soil P at Distance",Dist.Display,"km"),"Steady State",paste("Distance =",Dist.Display,"km")),
pch=NA,lwd=c(2,1),lty=c(2,1,3),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("soil Z:",soil.z.cm,"cm"))
head(time.dat.plot)
legend("bottomright",legend=c(paste("Soil P at Distance",Dist.Display,"km"),"Steady State",paste("Distance =",Dist.Display,"km")),
pch=NA,lwd=c(2,1),lty=c(2,1,3),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
plot(cattail.time.per~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Cattail Density (%)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,105))
lines(cattail.time.per$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$cattail.time.per,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$cattail.density.SS.per,col="red",lty=2,lwd=1)
aggregate(x=time.dat$cattail.time.per*wghts,by=list(time.dat$time.step),"sum")
aggregate(x=time.dat$cattail.time.per*wghts*(path.width.km*Dist.increment.km),by=list(time.dat$time.step),"sum")
wghts=ifelse(time.dat$dist==0|time.dat$dist==maxdist.km,0.5,1)
aggregate(x=time.dat$cattail.time.per*wghts,by=list(time.dat$time.step),"sum")
aggregate(catail=time.dat$cattail.time.per*wghts,by=list(time.dat$time.step),"sum")
aggregate(time.dat$cattail.time.per*wghts,by=list(time.dat$time.step),"sum")
path.width.km
Dist.increment.km
time.dat.plot$cattail.time.per
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtest(side=3,"Soil P")
legend("bottomright",legend=c(paste("Soil P at Distance",Dist.Display,"km"),"Steady State",paste("Distance =",Dist.Display,"km")),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
legend("bottomright",legend=c(paste("Soil P at Distance",Dist.Display,"km"),"Steady State",paste("Distance =",Dist.Display,"km")),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:2,2,1))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtest(side=3,"Soil P")
legend("bottomright",legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
Dist.slice=c(0,0.5,1,2,5,10)
Dist.slice
c(Dist.slice,Max.Dist)
Dist.slice<-c(Dist.slice,Max.Dist)
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
grey.colors(length(Dist.slice))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
cols<-grey.colors(length(Dist.slice))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2),widths=c(1,0.5))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
3
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.5))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
cols<-grey.colors(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",Dist.slice,"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",Dist.slice,"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#cols<-grey.colors(length(Dist.slice))
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab="Time (years)",ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
mtext(side=1,line=1.5,"Time (years)")
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.5,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(1,2),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#Graphs_Profile plots
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(1,2),lty=c(2,1),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#cols<-grey.colors(length(Dist.slice))
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(1,2),lty=c(1,2),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#cols<-grey.colors(length(Dist.slice))
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(1,),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#cols<-grey.colors(length(Dist.slice))
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(1,),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
par(family="serif",mar=c(3.25,4,2,2),oma=c(1,1,1,1),mgp=c(2.3,0.5,0));
layout(matrix(1:4,2,2,byrow=T),widths=c(1,0.4))
time.dat.plot<-time.dat[time.dat$dist==Dist.Display,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot$Avg.SoilP.mgkg)+max(time.dat.plot$Avg.SoilP.mgkg)*0.1)))
lines(time.dat.plot$time.step,time.dat.plot$Avg.SoilP.mgkg,col="red",lty=1,lwd=2)
lines(time.dat.plot$time.step,time.dat.plot$SoilP.SS.mgkg,col="red",lty=2,lwd=1)
mtext(side=3,"Soil P")
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c("Soil P","Steady State"),
pch=NA,lwd=c(2,1),lty=c(1,2),
col=c("red","red"),
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm\n Distance:",Dist.Display,"km"),title.adj = 0)
#cols<-grey.colors(length(Dist.slice))
cols<-rainbow(length(Dist.slice))
time.dat.plot2<-time.dat[time.dat$dist%in%Dist.slice,]
plot(Avg.SoilP.mgkg~time.step,time.dat.plot,type="n",las=1,xlab=NA,ylab="Concentration (mg kg\u207B\u00B9)",yaxs="i",xaxs="i",xlim=c(0,Max.Yrs),ylim=c(0,ceiling(max(time.dat.plot2$Avg.SoilP.mgkg)+max(time.dat.plot2$Avg.SoilP.mgkg)*0.1)))
for(i in 1:length(Dist.slice)){
with(time.dat.plot2[time.dat.plot2$dist==Dist.slice[i],],lines(time.step,Avg.SoilP.mgkg,lwd=2,col=cols[i]))
}
mtext(side=1,line=1.75,"Time (years)")
plot(0:1,0:1,type="n",axes=F,ylab=NA,xlab=NA)
legend(0.5,0.5,legend=c(paste("Distance:",format(Dist.slice),"km")),
pch=NA,lwd=c(2),lty=c(1),
col=cols,
pt.cex=1.25,ncol=1,bty="n",y.intersp=1,x.intersp=0.75,xpd=NA,xjust=0.5,yjust=0.5,title=paste("Soil Z:",soil.z.cm,"cm"),title.adj = 0)
